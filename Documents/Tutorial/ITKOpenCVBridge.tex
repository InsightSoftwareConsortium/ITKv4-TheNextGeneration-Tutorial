\section{ITK OpenCV Bridge}

\subsection{OpenCV Introduction}

\centeredlargetext{white}{black}{
ITK OpenCV Bridge
}




\begin{frame}
\frametitle{OpenCV Overview}
\begin{center}
\begin{columns}[c]
\column{0.8\textwidth}
\begin{itemize}
\item What is OpenCV?  OpenCV is \ldots
  \begin{itemize}
  \item an open source computer vision library.
  \item written in C, but has C++ and Python APIs.
  \item released under a BSD license.
  \item supported and guided by Willow Garage.
  \item found at \url{http://opencv.willowgarage.com/wiki/}.
  \end{itemize}
\end{itemize}
\column{0.2\textwidth}
 \includegraphics[width=0.8\textwidth]{../Art/OpenCVLogo.png}
\end{columns}
\pause
\begin{itemize}
\item We will be using OpenCV 2.4 (from subversion).
\item The new C++ interface will be used when possible.
\item We assume you have some prior experience with OpenCV
\item \ldots but we will cover the basics in case you don't.
\end{itemize}
\end{center}
\end{frame}



\begin{frame}
\frametitle{Introduction}
\begin{itemize}
\item ITK Module for working with other libraries
\item Moving frame and/or video data between OpenCV and ITK
\item Bring biomedical and computer vision folks together
\end{itemize}
\end{frame}



\begin{frame}
\frametitle{Design Choices}
\begin{itemize}
\item OpenCV users and ITK users should both be comfortable
\item Image to image utility functions
\item cv::Source to itk::VideoStream
\end{itemize}
\end{frame}

%-------------------------------------------
\subsection{Image Filtering}

\centeredlargetext{white}{black}{
Basic Image Filtering }

\begin{frame}
\frametitle{Include Header Files}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item We include ITK and OpenCV headers (like before):
\lstlistingwithnumber{20}{21}{BasicFilteringITKOpenCVBridge.cxx}
\lstlistingwithnumber{23}{24}{BasicFilteringITKOpenCVBridge.cxx}
\item We also need to include the bridge header:
\lstlistingwithnumber{25}{25}{BasicFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Basic Layout}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item The basic layout of this file is the same as the OpenCV
  Examples:
\lstlistingwithnumber{27}{35}{BasicFilteringITKOpenCVBridge.cxx}
\lstlistingwithnumber{69}{84}{BasicFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Adding ITK}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item The type definitions should also be familiar from the ITK
  Material:
\lstlistingwithnumber{38}{45}{BasicFilteringITKOpenCVBridge.cxx}
\item However, notice the bridge class. It contains the conversion function
between OpenCV and ITK.
\lstlistingwithnumber{42}{42}{BasicFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{From OpenCV to ITK}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item We call our conversion function to go from a cv::Mat to an
  itk::Image
\lstlistingwithnumber{47}{48}{BasicFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Filtering with ITK}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item The median filtering is normal ITK code, but we do not connect our
output to a writer
\lstlistingwithnumber{49}{64}{BasicFilteringITKOpenCVBridge.cxx}
\pause
\item Instead, we set it to our conversion function
\lstlistingwithnumber{66}{67}{BasicFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Running the Example}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item Run the example with the following command
\begin{verbatim}
      ./BasicFilteringITKOpenCVBridge     \
      ~/data/mandrillgray.png             \
      ./mandrillgrayMedian.png 
\end{verbatim}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Viewing the Results}
\framesubtitle{ITKOpenCVBridge/exercise1/BasicFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item Running the example the same way as before, we see a nicely
median-filtered image.
\end{itemize}
\begin{columns}[c]
\column{0.33\textwidth}
\begin{center}
\includegraphics[width=1\textwidth]{../Art/mandrilgray.png} \\
Original
\end{center}
\column{0.33\textwidth}
\begin{center}
\includegraphics[width=1\textwidth]{../Art/OpenCVITKex1.png} \\
Median Filter
\end{center}
\end{columns}
\end{frame}


\subsection{Video Filtering}
\centeredlargetext{white}{black}{
Basic Video Filtering
}

\begin{frame}
\frametitle{Basic Layout}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item The basic layout of this file is the same as the OpenCV Video
  Examples:
\item There are three functions as before.
\lstlistingwithnumber{28}{28}{BasicVideoFilteringITKOpenCVBridge.cxx}
\lstlistingwithnumber{63}{63}{BasicVideoFilteringITKOpenCVBridge.cxx}
\lstlistingwithnumber{89}{89}{BasicVideoFilteringITKOpenCVBridge.cxx}
\pause
\item We only need to modify {\tt processFrame} to incorporate ITK.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Filtering with ITK}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item The median filtering is again normal ITK code.
\lstlistingwithnumber{28}{29}{BasicVideoFilteringITKOpenCVBridge.cxx}
\lstlistingwithnumber{39}{60}{BasicVideoFilteringITKOpenCVBridge.cxx}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Running the Example}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridge.cxx}
\begin{itemize}
\item Run the example with the following command
\begin{verbatim}
      ./BasicVideoFilteringITKOpenCVBridge     \
      ~/data/Walk1.mpg                         \
      ./Walk1Median.mpg
\end{verbatim}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\frametitle{Exercise 2}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridge.cxx}
\item Let's modify this example to use the same canny edge detection
  from the ITK examples
\pause 
\item Hint 1: You should use the following function instead of ITK's
cast image filter for producing output
\lstlistingwithnumber{72}{72}{BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\pause
\item Hint 2: You should only have to modify {\tt processFrame}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\frametitle{Exercise 2: Answer}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\item You should now have some extra typedefs:
\lstlistingwithnumber{39}{44}{BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\frametitle{Exercise 2: Answer}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\item Your new ITK pipeline will look like this:
\lstlistingwithnumber{46}{67}{BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\frametitle{Exercise 2: Answer}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\item With the following code for output purposes:
\lstlistingwithnumber{69}{74}{BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Running the Answer}
\framesubtitle{ITKOpenCVBridge/exercise2/BasicVideoFilteringITKOpenCVBridgeAnswer.cxx}
\begin{itemize}
\item Run the answer with the following command
\begin{verbatim}
      ./BasicVideoFilteringITKOpenCVBridgeAnswer   \
      ~/data/Walk1.mpg                             \
      ./Walk1Edges.mpg
\end{verbatim}
\end{itemize}
\end{frame}



